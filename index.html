<!DOCTYPE html>
<html>
<head>
  <title>Pedidos Lanchonete</title>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <h1>Pedidos</h1>

  Produto: 
  <select id="produto">
    <option value="Hambúrguer">Hambúrguer - 15</option>
    <option value="Batata Frita">Batata Frita - 10</option>
    <option value="Refrigerante">Refrigerante - 5</option>
  </select>

  Quantidade: <input type="number" id="quantidade" value="1" min="1">

  <button id="addBtn">Adicionar Pedido</button>
  <button id="saveBtn">Salvar Excel</button>

  <table border="1" id="tabela">
    <thead>
      <tr><th>Produto</th><th>Quantidade</th><th>Preço Unitário</th><th>Total</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const pedidos = [];
    const tbody = document.querySelector("#tabela tbody");

    document.getElementById("addBtn").addEventListener("click", () => {
      const sel = document.getElementById("produto");
      const produto = sel.value.split(" - ")[0];
      const preco = parseFloat(sel.value.split(" - ")[1]);
      const quantidade = parseInt(document.getElementById("quantidade").value);

      const total = preco * quantidade;

      pedidos.push([produto, quantidade, preco, total]);

      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${produto}</td><td>${quantidade}</td><td>${preco}</td><td>${total}</td>`;
      tbody.appendChild(tr);
    });

    document.getElementById("saveBtn").addEventListener("click", () => {
      if(pedidos.length === 0) return alert("Nenhum pedido para salvar!");

      const ws = XLSX.utils.aoa_to_sheet([["Produto","Quantidade","Preço Unitário","Total"], ...pedidos]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "Pedidos");

      XLSX.writeFile(wb, "pedidos_lanchonete.xlsx");
    });
  </script>
</body>
</html>

</html>
